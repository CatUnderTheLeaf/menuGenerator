#:kivy 2.0.0
#:include myWidgets/NavigationDrawer.kv
#:include myWidgets/Tab.kv
#:include myWidgets/CustomButtons.kv
#:include myWidgets/AddTagsField.kv
#:include myWidgets/Dialogs.kv
#:include myWidgets/AllRecipesList.kv
#:include myWidgets/BottomSheet.kv
#:include myWidgets/Recipe.kv

MDScreen:

    MDBoxLayout:
        orientation: "vertical"
        
        MDNavigationLayout:

            ScreenManager:
                id: screen_manager
                
                MDScreen:   
                    name: "scr1"
                    
                    MDBoxLayout:
                        orientation: "vertical"

                        MDToolbar:
                            id: menu
                            pos_hint: {"top": 1}
                            title: "Menu"
                            left_action_items: [["menu", lambda x: nav_drawer.set_state("open")]]
                            right_action_items: [["refresh", lambda x: app.generateMenuTabs(), "reGenerate Menu"]]


                        MDTabs:
                            id: tabs
                            on_tab_switch: app.on_tab_switch(*args)
                
                MDScreen:
                    name: "scr2"

                    MDBoxLayout:
                        orientation: "vertical"
                        spacing: dp(5)

                        MDToolbar:
                            id: settings
                            pos_hint: {"top": 1}
                            title: "Settings"
                            left_action_items: [["menu", lambda x: nav_drawer.set_state("open")]]

                        ScrollView:
                            
                            MDGridLayout:
                                padding: dp(20)
                                spacing: dp(10)
                                cols: 1
                                adaptive_height: True
                                
                                MDLabel:
                                    text: "Time period"
                                    
                                Widget:
                                    size_hint_y: None
                                    height: dp(5)
                                
                                MDStackLayout:
                                    adaptive_height: True
                                    spacing: dp(5)
                                    id: timePeriod

                                    MyToggleButton:
                                        text: "day"
                                        icon: "calendar-today"
                                        group: "timePeriod"
                                        on_release: app.set_n_days(self.text)
                                    
                                    MyToggleButton:
                                        text: "week"
                                        icon: "calendar-week"
                                        group: "timePeriod"
                                        on_release: app.set_n_days(self.text)
                                    
                                    MyToggleButton:
                                        text: "month"
                                        icon: "calendar-month"
                                        group: "timePeriod"
                                        on_release: app.set_n_days(self.text)
                                
                                MDSeparator:
                                
                                MDGridLayout:
                                    cols: 2
                                    adaptive_height: True                            

                                    MDLabel:
                                        text: "Repeat dishes"

                                    MDSwitch:
                                        id: repeatDishes
                                        on_active: app.on_repeat_switch(*args)                                    
                                
                                MDSeparator:
                                
                                Widget:
                                    size_hint_y: None
                                    height: dp(5)
                            
                                MDLabel:
                                    text: "Meals"

                                Widget:
                                    size_hint_y: None
                                    height: dp(5)

                                MDGridLayout:
                                    cols: 1
                                    adaptive_height: True
                                    spacing: dp(5)
                                    id: meals                                

                                    MDChip:
                                        text: "Breakfast"                                    
                                        icon: "bowl-mix"
                                        value: 0
                                        on_release: app.on_meal_check(self, self.value)
                                        check: True

                                    MDChip:
                                        text: "Brunch"
                                        icon: "food-variant"
                                        value: 1
                                        on_release: app.on_meal_check(self, self.value)
                                        check: True

                                    MDChip:
                                        text: "Lunch"
                                        icon: "pasta"
                                        value: 2
                                        on_release: app.on_meal_check(self, self.value)
                                        check: True
                                    
                                    MDChip:
                                        text: "Supper"
                                        icon: "pot-steam"
                                        value: 3
                                        on_release: app.on_meal_check(self, self.value)
                                        check: True

                                    MDChip:
                                        text: "Dinner"
                                        icon: "noodles"
                                        value: 4
                                        on_release: app.on_meal_check(self, self.value)
                                        check: True                                
                                
                                MDSeparator:

                MDScreen:
                    name: "scr3"
                    
                    MDBoxLayout:
                        orientation: "vertical"
            
                        MDToolbar:
                            id: recipeListToolbar
                            pos_hint: {"top": 1} 
                            title: "All recipes"
                            left_action_items: [["menu", lambda x: nav_drawer.set_state("open")]]
                            

                        ScrollView:

                            RecipeSelectionList:
                                id: recipe_scroll
                            
                        
                    MDFloatingActionButton:
                        icon: "plus"
                        theme_text_color: "Custom"
                        elevation_normal: 12
                        y: dp(10)
                        x: Window.width - (dp(56) + dp(10))
                        on_release: app.edit_recipe()

                MDScreen:
                    name: "scr4"
                    
                    MDBoxLayout:
                        orientation: "vertical"
            
                        MDToolbar:
                            id: editRecipeBar
                            pos_hint: {"top": 1} 
                            title: "Edit recipe"
                            left_action_items: [["arrow-left", lambda x: app.returnBack()]]
                            right_action_items: [["check", lambda x: app.saveRecipe(editRecipeScroll.children[0]), "save"]]


                        ScrollView:
                            id: editRecipeScroll
                                
                                
                
            MDNavigationDrawer:
                id: nav_drawer

                ContentNavigationDrawer:
                    screen_manager: screen_manager
                    nav_drawer: nav_drawer