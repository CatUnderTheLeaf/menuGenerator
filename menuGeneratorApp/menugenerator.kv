#:kivy 2.0.0
#:include myWidgets/NavigationDrawer.kv
#:include myWidgets/CustomButtons.kv
#:include myWidgets/AddTagsField.kv
#:include myWidgets/Dialogs.kv
#:include myWidgets/BottomSheet.kv
#:include myWidgets/Tab.kv
#:include myWidgets/MenuSettings.kv
#:include myWidgets/AllRecipesList.kv
#:include myWidgets/Recipe.kv

MDScreen:

    MDBoxLayout:
        orientation: "vertical"
        
        MDNavigationLayout:

            ScreenManager:
                id: screen_manager
                
                MDScreen:   
                    name: "scr1"
                    
                    MDBoxLayout:
                        orientation: "vertical"

                        MDToolbar:
                            id: menu
                            pos_hint: {"top": 1}
                            title: "Menu"
                            left_action_items: [["menu", lambda x: nav_drawer.set_state("open")]]
                            right_action_items: [["refresh", lambda x: app.generateMenuTabs(), "reGenerate Menu"]]


                        MDTabs:
                            id: tabs
                            on_tab_switch: app.on_tab_switch(*args)
                
                MDScreen:
                    name: "scr2"

                    MDBoxLayout:
                        orientation: "vertical"
                        spacing: dp(5)
                        id: settingsBox

                        MDToolbar:
                            id: settings
                            pos_hint: {"top": 1}
                            title: "Settings"
                            left_action_items: [["menu", lambda x: app.saveSettingsDialog(settingsScroll.children[0]) if settingsScroll.children[0].hasChanged() else nav_drawer.set_state("open")]]

                        # MenuSettings:
                        ScrollView:
                            id: settingsScroll

                MDScreen:
                    name: "scr3"
                    
                    MDBoxLayout:
                        orientation: "vertical"
            
                        MDToolbar:
                            id: recipeListToolbar
                            pos_hint: {"top": 1} 
                            title: "All recipes"
                            left_action_items: [["menu", lambda x: nav_drawer.set_state("open")]]
                            

                        ScrollView:

                            RecipeSelectionList:
                                id: recipe_scroll
                            
                        
                    MDFloatingActionButton:
                        icon: "plus"
                        theme_text_color: "Custom"
                        elevation_normal: 12
                        y: dp(10)
                        x: Window.width - (dp(56) + dp(10))
                        on_release: app.edit_recipe()

                MDScreen:
                    name: "scr4"
                    
                    MDBoxLayout:
                        orientation: "vertical"
            
                        MDToolbar:
                            id: editRecipeBar
                            pos_hint: {"top": 1} 
                            title: "Edit recipe"
                            left_action_items: [["arrow-left", lambda x: app.returnBack()]]
                            right_action_items: [["check", lambda x: app.saveRecipe(editRecipeScroll.children[0]), "save"]]


                        ScrollView:
                            id: editRecipeScroll
                                
                                
                
            MDNavigationDrawer:
                id: nav_drawer

                ContentNavigationDrawer:
                    screen_manager: screen_manager
                    nav_drawer: nav_drawer