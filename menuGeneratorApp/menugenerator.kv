#:kivy 2.0.0
<ContentNavigationDrawer>:
    orientation: "vertical"
    padding: "8dp"
    spacing: "8dp"
    screen_manager: root.screen_manager
    nav_drawer: root.nav_drawer

    AnchorLayout:
        anchor_x: "left"
        size_hint_y: None
        height: avatar.height

        Image:
            id: avatar
            size_hint: None, None
            size: "56dp", "56dp"
            source: "data/logo/kivy-icon-256.png"

    MDLabel:
        text: "Menu Generator"
        font_style: "Button"
        adaptive_height: True

    ScrollView:
        screen_manager: root.screen_manager
        nav_drawer: root.nav_drawer

        DrawerList:
            id: md_list
            screen_manager: root.screen_manager
            nav_drawer: root.nav_drawer
            
            ItemDrawer:
                text: "Menu"
                text_color: app.theme_cls.primary_color
                cur_screen: "scr1"
                icon: "book-open-variant"

            ItemDrawer:
                text: "Settings"
                cur_screen: "scr2"
                icon: "cog"

            ItemDrawer:
                text: "Recipes"
                cur_screen: "scr3"
                icon: "nutrition"

<ItemDrawer>:
    theme_text_color: "Custom"
    on_press:
        self.parent.set_color_item(self)
        self.parent.nav_drawer.set_state("close")
        self.parent.screen_manager.current = root.cur_screen
        

    IconLeftWidget:
        icon: root.icon
        theme_text_color: "Custom"
        text_color: root.text_color

<Tab>:
    MDBoxLayout:
        orientation: "vertical"
        
        ScrollView:

            MDGridLayout:
                cols: 1
                adaptive_height: True
                id: box

<Content>:
    size_hint_y: None
    height: recipe_text.height

    MDBoxLayout:
        orientation: "vertical"
        adaptive_height: True

        MDLabel:
            id: recipe_text
            text: root.text

<SwipeToDeleteItem>:
    size_hint_y: None
    height: listItem.height

    MDCardSwipeLayerBox:
        padding: "8dp"

        MDIconButton:
            icon: "trash-can"
            pos_hint: {"center_y": .5}
            theme_text_color: "Custom"
            text_color: "red"
            on_release: app.remove_recipe_from_list(root)

    MDCardSwipeFrontBox:

        TwoLineAvatarIconListItem:
            id: listItem
            text: root.text
            secondary_text: root.secondary_text
            _no_ripple_effect: True

            ImageLeftWidget:
                source: root.source
            IconRightWidget:
                icon: "pencil-outline"
                theme_text_color: "Custom"
                text_color: app.theme_cls.primary_color
                on_release: app.edit_recipe(root)


MDScreen:

    MDBoxLayout:
        orientation: "vertical"
        
        MDNavigationLayout:

            ScreenManager:
                id: screen_manager
                
                MDScreen:   
                    name: "scr1"
                    
                    MDBoxLayout:
                        orientation: "vertical"

                        MDToolbar:
                            id: menu
                            pos_hint: {"top": 1}
                            title: "Menu"
                            left_action_items: [["menu", lambda x: nav_drawer.set_state("open")]]
                            right_action_items: [["refresh", lambda x: app.generateMenuTabs(), "reGenerate Menu"]]


                        MDTabs:
                            id: tabs
                            on_tab_switch: app.on_tab_switch(*args)
                
                MDScreen:
                    name: "scr2"

                    MDBoxLayout:
                        orientation: "vertical"
                        spacing: dp(5)

                        MDToolbar:
                            id: settings
                            pos_hint: {"top": 1}
                            title: "Settings"
                            left_action_items: [["menu", lambda x: nav_drawer.set_state("open")]]
                            right_action_items: [["refresh", lambda x: app.generateMenuTabs(), "reGenerate Menu"]]

                        ScrollView:
                            
                            MDGridLayout:
                                padding: dp(20)
                                spacing: dp(10)
                                cols: 1
                                adaptive_height: True
                                
                                MDLabel:
                                    text: "Time period"
                                    
                                Widget:
                                    size_hint_y: None
                                    height: dp(5)
                                
                                MDStackLayout:
                                    adaptive_height: True
                                    spacing: dp(5)
                                    id: timePeriod

                                    MDChip:
                                        text: "day"
                                        icon: "circle-outline"
                                        on_release: app.on_timePeriod_check(self, self.text)
                                        check: True

                                    MDChip:
                                        text: "week"
                                        icon: "circle-slice-2"
                                        on_release: app.on_timePeriod_check(self, self.text)
                                        check: True

                                    MDChip:
                                        text: "month"
                                        icon: "circle-slice-4"
                                        on_release: app.on_timePeriod_check(self, self.text)
                                        check: True
                                
                                MDSeparator:
                                
                                MDGridLayout:
                                    cols: 2
                                    adaptive_height: True                            

                                    MDLabel:
                                        text: "Repeat dishes"

                                    MDSwitch:
                                        id: repeatDishes
                                        on_active: app.on_repeat_switch(*args)                                    
                                
                                MDSeparator:
                                
                                Widget:
                                    size_hint_y: None
                                    height: dp(5)
                            
                                MDLabel:
                                    text: "Meals"

                                Widget:
                                    size_hint_y: None
                                    height: dp(5)

                                MDGridLayout:
                                    cols: 1
                                    adaptive_height: True
                                    spacing: dp(5)
                                    id: meals                                

                                    MDChip:
                                        text: "Breakfast"                                    
                                        icon: "bowl-mix"
                                        value: 0
                                        on_release: app.on_meal_check(self, self.value)
                                        check: True

                                    MDChip:
                                        text: "Brunch"
                                        icon: "food-variant"
                                        value: 1
                                        on_release: app.on_meal_check(self, self.value)
                                        check: True

                                    MDChip:
                                        text: "Lunch"
                                        icon: "pasta"
                                        value: 2
                                        on_release: app.on_meal_check(self, self.value)
                                        check: True
                                    
                                    MDChip:
                                        text: "Supper"
                                        icon: "pot-steam"
                                        value: 3
                                        on_release: app.on_meal_check(self, self.value)
                                        check: True

                                    MDChip:
                                        text: "Dinner"
                                        icon: "noodles"
                                        value: 4
                                        on_release: app.on_meal_check(self, self.value)
                                        check: True                                
                                
                                MDSeparator:

                MDScreen:
                    name: "scr3"
                    
                    MDBoxLayout:
                        orientation: "vertical"
            
                        MDToolbar:
                            id: recipeList
                            pos_hint: {"top": 1} 
                            title: "All recipes"
                            left_action_items: [["menu", lambda x: nav_drawer.set_state("open")]]
                            

                        ScrollView:

                            MDList:
                                id: recipe_scroll

                MDScreen:
                    name: "scr4"
                    
                    MDBoxLayout:
                        orientation: "vertical"
            
                        MDToolbar:
                            id: editRecipeBar
                            pos_hint: {"top": 1} 
                            title: "Edit recipe"
                            left_action_items: [["arrow-left", lambda x: app.returnBack()]]
                            right_action_items: [["check", lambda x: app.saveRecipe(), "save"]]


                        ScrollView:

                            MDBoxLayout:
                                id: editRecipe
                                orientation: "vertical"
                                adaptive_height: True
                                padding: dp(48)
                                spacing: dp(15)
                                
                                MDTextField:
                                    id: recipeTitle
                                    hint_text: "Title"
                                    required: True
                                    helper_text_mode: "on_error"

                                MDLabel:
                                    text: "Ingridients"

                                MDStackLayout:
                                    adaptive_height: True
                                    spacing: dp(5)
                                    id: recipeIngridients
                                
                                MDSeparator:

                                MDLabel:
                                    text: "Prepare time"

                                MDStackLayout:
                                    adaptive_height: True
                                    spacing: dp(5)
                                    id: recipePrepareTime

                                    MDChip:
                                        text: "short"
                                        icon: "circle-outline"
                                        # on_release: app.on_timePeriod_check(self, self.text)
                                        check: True

                                    MDChip:
                                        text: "medium"
                                        icon: "circle-slice-2"
                                        # on_release: app.on_timePeriod_check(self, self.text)
                                        check: True

                                    MDChip:
                                        text: "long"
                                        icon: "circle-slice-4"
                                        # on_release: app.on_timePeriod_check(self, self.text)
                                        check: True

                                MDSeparator:

                                MDLabel:
                                    text: "Tags"

                                MDStackLayout:
                                    adaptive_height: True
                                    spacing: dp(5)
                                    id: recipeTags

                                MDSeparator:

                                MDGridLayout:
                                    cols: 2
                                    adaptive_height: True                            

                                    MDLabel:
                                        text: "Repeat dish?"

                                    MDSwitch:
                                        id: recipeRepeatDish
                                        # on_active: app.on_repeat_switch(*args)

                                MDSeparator:

                                MDTextField:
                                    id: recipeDescription
                                    multiline: True
                                    hint_text: "Prepare instructions"
                                
                
            MDNavigationDrawer:
                id: nav_drawer

                ContentNavigationDrawer:
                    screen_manager: screen_manager
                    nav_drawer: nav_drawer